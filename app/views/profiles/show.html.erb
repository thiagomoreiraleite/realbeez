<div class="container mt-5">
  <div class="row">
    <div class="col-12 col-md-4">
    </div>
    <div class="col-12 col-md-8">
      <h2 class="mb-3" ><%= @profile.prénom.capitalize %> <%= @profile.nom.capitalize %>'s profile</h2>
    </div>
  </div>

  <% if policy(@profile).show? %>
    <!-- 1 - PROFILE IMG -->
    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-4 p-0">
        <div class="d-flex justify-content-center p-0 mb-0", style="border-radius: 5px">
          <div class="rounded p-5">
            <div class="text-center mb-3">
              <%= image_tag (cl_image_path @profile.photo), crop: :fill, style:"object-fit:cover; height: 30vh; width: 30vh", class: "rounded-circle center" %>
            </div>
            <p class="font-weight-bold text-center mt-2 mb-0"><%= @profile.prénom.capitalize %> <%= @profile.nom.capitalize %></p>
            <p class="text-center mt-0 mb-3" style="font-size: 12px" ><%= @profile.ville %></p>
          </div>
        </div>
      </div>

      <!-- 2 - OTHER INFO -->
      <div class="col-sm-12 col-md-12 col-lg-8" style="border-radius: 10px">
        <div class="pb-2 border-bottom border-info">
          <% if @profile == current_user %>
            <%= link_to "Edit my profile", edit_user_registration_path(current_user), class: "btn btn-link p-0" %>
          <% else %>
            <%= link_to  "Voir mes annonces", annonces_path(user_id: @profile.id), class: "btn btn-link p-0" %>
          <% end %>
        </div>

        <p class="text-center my-5" style="font-weight: bold; font-size: 24px;">Mes connexions</p>
        <div class="col mr-0">
          <div class= "row d-flex">
            <% User.find(params[:id]).friends.each do |friend| %>
              <div class="col-4 col-md-2">
                <div class="text-center">
                  <%= link_to (cl_image_tag friend.photo, crop: :fill, style:"object-fit:cover; height: 50px; width: 50px", class: "rounded-circle center justify-content-center text-center"), profile_path(friend)  %>
                </div>
                <div class="text-center mt-1 mb-4 text-black-50" style="">
                  <%= friend.prénom %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
        <p class="pt-4 text-center pb-2 my-5" style="font-weight: bold; width: auto; font-size: 24px">Tableau de bord</p>

      <p style="font-weight: bold">Disponibilités pour effectuer les visites</p>

      <%= month_calendar events: @meetings do |date, meetings| %>
        <p class="text-truncate" style='font-size: 10px'><%= date.strftime("%d") %></p>
        <% meetings.each do |meeting| %>
          <div>
            <p class="text-truncate" style='font-size: 10px'><%= meeting.name %></p>

          </div>
        <% end %>
      <% end %>

      <p id="notice"><%= notice %></p>

      <h1>Rendez-vous</h1>
      <table>
        <thead>
          <tr>
            <th>Titre</th>
            <th>Annonce</th>
            <th>Date</th>
            <th>de</th>
            <th>à</th>
            <th colspan="3"></th>
          </tr>
        </thead>

        <tbody>
          <% @meetings.each do |meeting| %>
            <tr>
              <td><%= meeting.name %></td>
              <td><%= meeting.annonce.titre_annonce %></td>a
              <td><%= meeting.start_time.strftime("%d/%m/%Y") %></td>
              <td><%= meeting.start_time.strftime("%l:%M") %></td>
              <td><%= meeting.end_time.strftime("%l:%M") %></td>
              <td><%= link_to 'Show', meeting %></td>
              <td><%= link_to 'Edit', edit_meeting_path(meeting) %></td>
              <td><%= link_to 'Destroy', meeting, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <br>

      <%= link_to 'New Meeting', new_meeting_path %>
      </div>
    </div>



    <div class="container" style="text-align: center">
      <% if user_signed_in? && params[:id].to_i != current_user.id %>
        <h2 class="text-center mb-4 mt-5" style="font-weight: bold">Demander les services de <%= @profile.prénom.capitalize %></h2>
        <div class="row justify-content-center">
          <div class="col-12 col-md-6 col-md-offset-3">
            <%= simple_form_for @candidature do |f| %>
              <%= f.input :annonce_id, label: "Choisir l'annonce:", include_blank: false, collection: @annonces,label_method: :titre_annonce, value_method: :id%>
              <%= f.hidden_field :user_id, value: @profile.id %>

              <%= f.submit "Valider", class: "btn btn-success mt-4 mb-5" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

  <% end %>
</div>






















